javascript:(function(){function n(n,e){return Sfdc.String.format(n,e)}function e(n){var e=document.createElement("script");e.onload=function(){sforce.connection.sessionId=ApiUtils.getSessionId(),n()},e.src="/soap/ajax/27.0/connection.js",document.head.appendChild(e)}function t(){var e,t,r;e=o(),t=new sforce.SObject("Document"),t.Id=a,t.ContentType=e,c(t),r=n("このドキュメントのMIMEタイプを {old} から {new} に変更します。\nよろしいですか？",{old:e,"new":t.ContentType}),confirm(r)&&s(t)}function o(){var e,t=n("SELECT ContentType FROM Document WHERE Id = '{id}'",{id:a});return e=sforce.connection.query(t),e.records.ContentType}function c(n){/; *?charset/i.test(n.ContentType)?i(n):r(n)}function r(n){n.ContentType=n.ContentType+"; charset=UTF-8"}function i(n){n.ContentType=n.ContentType.replace(/; *?charset=UTF-8/i,"")}function s(n){var e;e=sforce.connection.update([n]),e[0].getBoolean("success")?location.reload():(alert("更新に失敗しました。"),console.log(e))}var a=sfdcPage.getEntityId();return/^015/.test(a)?(window.sforce?t():e(t),void 0):(alert("対象ドキュメントの参照画面で実行してください"),void 0)})();